const{__:__,_x:_x,_n:_n,_nx:_nx}=wp.i18n;export function moduleData(){return{props:{display:String,name:String,block:Object},data:function(){return{searchString:"",results:[],page:1,totalPages:0,totalFound:0,strings:{searchPlaceHolder:__("Search content","uipress-lite"),nothingFound:__("Nothing found for query","uipress-lite"),by:__("by","uipress-lite"),found:__("found","uipress-lite")},searching:!1}},inject:["uipData","uipress","uiTemplate"],watch:{searchString:{handler(e,i){""!=e?(this.page=1,this.searchContent()):this.results=[]},deep:!0},page:{handler(e,i){""!=e&&this.searchContent()},deep:!0}},computed:{getPostTypes(){return this.uipress.get_block_option(this.block,"block","searchPostTypes")}},methods:{searchContent(){let e=this;if(e.searching)return;e.searching=!0;let i=[];void 0!==e.getPostTypes&&Array.isArray(e.getPostTypes)&&(i=e.getPostTypes),i=JSON.stringify(i);let t=e.uipress.get_block_option(this.block,"block","limitToAuthor"),s=new FormData;s.append("action","uip_search_content"),s.append("security",uip_ajax.security),s.append("search",e.searchString),s.append("page",e.page),s.append("limitToauthor",t),s.append("postTypes",i),e.uipress.callServer(uip_ajax.ajax_url,s).then(i=>{i.error&&(e.uipress.notify(i.message,"uipress-lite","","error",!0),e.searching=!1),i.success&&(e.searching=!1,e.results=i.posts,e.totalPages=i.totalPages,e.totalFound=i.totalFound)})},goBack(){this.page>1&&(this.page=this.page-1)},goForward(){this.page<this.totalPages&&(this.page=this.page+1)},formatHighlight(e){if(e.toLowerCase().includes(this.searchString.toLowerCase())){let i=new RegExp("("+this.searchString+")","gi");e=e.replace(i,"<uip-highlight>"+this.searchString+"</uip-highlight>")}return e}},template:'\n            <div class="uip-flex uip-flex-column" :id="block.uid" :class="block.settings.advanced.options.classes.value">\n              <div class="">\n                <div class="uip-flex uip-padding-xxs uip-border uip-search-block uip-border-round uip-flex-center uip-margin-bottom-s">\n                  <span class="uip-icon uip-text-muted uip-margin-right-xs">search</span> \n                  <input class="uip-blank-input uip-flex-grow uip-text-s" type="search" :placeholder="strings.searchPlaceHolder" v-model="searchString" autofocus="">\n                </div>\n              </div>\n              <div class="uip-flex uip-flex-row uip-flex-center uip-flex-middle uip-padding-m" v-if="searching"><loading-chart></loading-chart></div>\n              <div v-if="results.length > 0" class="uip-flex uip-flex-column uip-row-gap-xs uip-padding-xxs uip-search-results-area">\n                <template v-for="item in results">\n                  <div class="uip-flex uip-flex-row uip-flex-between uip-flex-center" @mouseover="item.hover = true" @mouseleave="item.hover = false">\n                    <div class="">\n                      <div class="uip-flex uip-flex-row uip-gap-xxs uip-flex-center" >\n                        <div class="uip-text-bold uip-search-result-title uip-link-default uip-cursor-pointer"  @click="uipress.updatePage(item.link)" v-html="formatHighlight(item.name)"></div>\n                        <div class="uip-text-xs uip-background-primary-wash uip-border-round uip-padding-xxxs">{{item.type}}</div>\n                        <div class="uip-flex uip-gap-xxs uip-flex-center" v-if="item.hover">\n                          <div @click="uipress.updatePage(item.editLink)" :href="item.editLink" class="uip-icon uip-cursor-pointer uip-link-muted">edit_document</div>\n                          <a :href="item.link" target="_BLANK" class="uip-icon uip-cursor-pointer uip-link-muted uip-no-underline">open_in_new</a>\n                        </div>\n                      </div>\n                      <div class="uip-text-s uip-search-result-meta uip-flex uip-flex-row uip-gap-xxxs">\n                        <span class="uip-text-muted">{{strings.by}}</span>\n                        <span class="">{{item.author}}</span>\n                        <span class="uip-text-muted">{{item.modified}}</span>\n                      </div>\n                    </div>\n                  </div>\n                </template>\n                <div v-if="results.length == 0 && searchString.length > 0" class="uip-text-muted uip-text-s">\n                  {{strings.nothingFound}} {{searchString}}\n                </div>\n              </div>\n              \n              <div class="uip-flex uip-flex-between uip-gap-xxs uip-flex-center" v-if="searchString != \'\'">\n                <div class="">{{totalFound}} {{strings.found}}</div>\n                <div class="uip-flex uip-gap-xs uip-padding-xs" v-if="totalPages > 1">\n                  <button @click="goBack" class="uip-button-default uip-icon uip-search-nav-button">chevron_left</button>\n                  <button @click="goForward" v-if="page < totalPages" class="uip-button-default uip-icon uip-search-nav-button">chevron_right</button>\n                </div>\n              </div>\n            </div>'}};