const{__:__,_x:_x,_n:_n,_nx:_nx}=wp.i18n;export function moduleData(){return{inject:["uipData","router","uipress","uiTemplate"],data:function(){return{loading:!0,themes:[],search:"",activeTemplate:!1,imageIndex:0,imageHover:!1,strings:{missingMessage:__("This block no longer exists","uipress-lite"),templateLibrary:__("Template library","uipress-lite"),pro:__("Pro","uipress-lite"),searchTemplates:__("Search templates","uipress-lite"),backToAllThemes:__("Back to all templates","uipress-lite"),includesProBlocks:__("Includes pro blocks","uipress-lite"),createdBy:__("Created by","uipress-lite"),addToTemplate:__("Add to template","uipress-lite"),replaceContent:__("Replace current layout","uipress-lite"),addAtEndOfContent:__("Add to end of layout","uipress-lite"),requires:__("Requires uipress","uipress-lite"),downloadcount:__("How many times this template has been downloaded","uipress-lite"),sortBy:__("Sort by","uipress-lite"),include:__("Include","uipress-lite")},sortby:"downloads",sortOptions:{downloads:{label:__("Downloads","uipress-lite"),value:"downloads"},newest:{label:__("Newest","uipress-lite"),value:"newest"},oldest:{label:__("Oldest","uipress-lite"),value:"oldest"}},typeOptions:{uiTemplates:{label:__("UI templates","uipress-lite"),value:"ui-template",selected:!0},adminPages:{label:__("Admin pages","uipress-lite"),value:"ui-admin-page",selected:!0}}}},watch:{sortby:{handler(e,i){this.fetchThemes()}},typeOptions:{handler(e,i){this.fetchThemes()},deep:!0}},mounted:function(){this.fetchThemes()},computed:{returnSortBy(){return this.sortby},returnFilter(){let e="";for(let i in this.typeOptions)this.typeOptions[i].selected&&(e+=this.typeOptions[i].value+"||");return""==e&&(this.typeOptions.uiTemplates.selected=!0),e}},methods:{goBack(){let e=this.$route.params.templateID;this.router.push("/uibuilder/"+e+"/")},fetchThemes(){let e=this;e.loading=!0;let i=new FormData,t="https://api.uipress.co/templates/list/?sort="+this.returnSortBy+"&filter="+this.returnFilter;e.uipress.callServer(t,i).then(i=>{i.error&&(e.uipress.notify(i.message,"uipress-lite","","error",!0),e.loading=!1),e.loading=!1,e.themes=i})},inSearch(e){if(""==this.search)return!0;let i=this.search.toLowerCase();return!!e.name.toLowerCase().includes(i)||!!e.description.toLowerCase().includes(i)},addToContent(e,i){let t=this,s=i.type,p=new FormData,n="https://api.uipress.co/templates/get/?templateid="+t.activeTemplate.ID,a=t.uipress.notify(__("Importing template","uipress-lite"),"","default",!1,!0);t.uipress.callServer(n,p).then(i=>{i.error&&(t.uipress.notify(i.message,"uipress-lite","","error",!0),t.uipress.destroy_notification(a)),t.uipress.destroy_notification(a);let p=i;t.injectTemplate(p,e,s)})},injectTemplate(e,i,t){let s=!1;try{s=JSON.parse(e)}catch(e){return void this.uipress.notify(__("Unable to import template","uipress-lite"),e,"error",!0,!1)}let p=JSON.parse(JSON.stringify(this.uiTemplate.content));if(Array.isArray(s)){let e=[];for(const i of s)e.push(this.cleanBlock(i));if("replace"==i&&(this.uiTemplate.content=e),"add"==i)for(const i of e)this.uiTemplate.content.push(i);"Layout"==t?this.uiTemplate.globalSettings.type="ui-template":"Admin Page"==t&&(this.uiTemplate.globalSettings.type="ui-admin-page")}let n=JSON.parse(JSON.stringify(this.uiTemplate.content));this.uipress.logHistoryChange(__("Template imported from library","uipress-lite"),p,n),this.uipress.notify(__("Template added","uipress-lite"),"","success",!0,!1)},cleanBlock(e){let i=Object.assign({},e);return i.options=[],i.settings=JSON.parse(JSON.stringify(i.settings)),i.content&&(i.content=this.duplicateChildren(i.content)),i},duplicateChildren(e){let i=[];for(let t of e){let e=Object.assign({},t);e.settings=JSON.parse(JSON.stringify(e.settings)),e.content&&(e.content=this.duplicateChildren(e.content)),i.push(e)}return i},getBackgroundImg:e=>'background-image:url("'+e+'");',navImagesForward(){this.imageIndex+1>this.activeTemplate.images.length-1?this.imageIndex=0:this.imageIndex+=1},navImagesBackward(){this.imageIndex-1<0?this.imageIndex=this.activeTemplate.images.length-1:this.imageIndex-=1}},template:'<div class="uip-background-default uip-flex uip-flex-column uip-border-box">\n      \n\t\t    <div class="uip-flex uip-flex-column uip-h-100p uip-max-h-100p">\n          \x3c!--Title block --\x3e\n          <div class="uip-margin-bottom-s">\n            <div class="">\n\t\t          <div class="uip-flex uip-gap-xs uip-margin-bottom-xxs uip-flex-center uip-flex-between">\n                <div class="uip-text-bold uip-blank-input uip-text-l">{{strings.templateLibrary}}</div>\n\t\t          </div>\n            </div>\n          </div>\n          \x3c!--EndTitle block --\x3e\n            \n          <template v-if="!activeTemplate">\n            \x3c!--Filters and search--\x3e\n            <div class="uip-flex uip-flex-row uip-gap-xs uip-flex-center uip-margin-bottom-s">\n              <drop-down>\n                <template v-slot:trigger>\n                  <uip-tooltip :message="strings.sortBy">\n                    <div class="uip-link-muted uip-padding-xxxs uip-border-round hover:uip-background-muted">\n                      <span class="uip-icon uip-text-xl">sort</span>\n                    </div>\n                  </uip-tooltip>\n                </template>\n                <template v-slot:content>\n                  <div class="uip-flex uip-flex-column">\n                    \n                    <div class="uip-padding-xxs uip-border-bottom">\n                      <div class="uip-padding-xxs uip-text-muted">{{strings.sortBy}}</div>\n                      <template v-for="item in sortOptions">\n                        <div @click="sortby = item.value"\n                        class="uip-w-150 uip-padding-xxs uip-border-round hover:uip-background-muted uip-cursor-pointer uip-flex uip-flex-row uip-flex-between uip-flex-center" :class="{\'uip-background-grey\' : item.value == sortby}">\n                          <span>{{item.label}}</span>\n                          <span v-if="item.value == sortby" class="uip-icon uip-text-l">done</span>\n                        </div>\n                      </template>\n                    </div>\n                    \n                    <div class="uip-padding-xxs">\n                      <div class="uip-padding-xxs uip-text-muted">{{strings.include}}</div>\n                      <template v-for="item in typeOptions">\n                        <label @click="sortby = item.value"\n                        class="uip-w-150 uip-padding-xxs uip-border-round hover:uip-background-muted uip-cursor-pointer uip-flex uip-flex-row uip-gap-xxs uip-flex-center">\n                          \n                          <input class="uip-checkbox" type="checkbox" v-model="item.selected">\n                          <span>{{item.label}}</span>\n                          \n                        </label>\n                      </template>\n                    </div>\n                    \n                  </div>\n                </template>\n              </drop-down>\n              \n              <div class="uip-flex uip-padding-xxs uip-border-bottom uip-search-block uip-flex-grow">\n                <span class="uip-icon uip-text-muted uip-margin-right-xs uip-text-l uip-icon uip-icon-medium">search</span>\n                <input class="uip-blank-input uip-flex-grow uip-text-s" type="search" :placeholder="strings.searchTemplates" autofocus="" v-model="search">\n              </div>\n            </div>\n            \x3c!--Filters and search--\x3e\n          \n        \n            <div v-if="loading" class="uip-padding-m uip-flex uip-flex-center uip-flex-middle"><loading-chart></loading-chart></div>\n        \n            <div v-else class="uip-flex uip-flex-column uip-row-gap-s uip-flex-grow uip-overflow-auto uip-scrollbar uip-padding-bottom-l" >\n              <template v-for="theme in themes">\n                <div v-if="inSearch(theme)" >\n                  <div class="uip-border-round uip-padding-xxs hover:uip-background-muted uip-cursor-pointer uip-pattern-drag" @click="activeTemplate = theme">\n                    <div class="uip-flex uip-flex-column uip-row-gap-xs uip-flex-left">\n                      <img :src="theme.img" :alt="theme.theme_title" class="uip-w-100p uip-h-100p uip-border uip-border-round uip-ratio-16-10">\n                      <div class="uip-flex uip-flex-column uip-row-gap-xxxs uip-flex-shrink">\n                        <div class="uip-flex uip-flex-between">\n                          <div class="uip-flex uip-flex-row uip-gap-xxs uip-flex-center">\n                            <span class="uip-text-emphasis uip-text-bold">{{theme.name}}</span>\n                            <div class="uip-flex uip-flex-row uip-gap-xxs uip-flex-center">\n                              <span class="uip-text-xs uip-background-primary-wash uip-border-round uip-padding-xxxs uip-post-type-label">{{theme.type}}</span>\n                              <uip-tooltip :message="strings.downloadcount">\n                                <div class="uip-text-xs uip-background-primary-wash uip-border-round uip-padding-xxxs uip-post-type-label uip-flex uip-flex-row uip-gap-xxxs">\n                                  <span class="uip-icon">file_download</span>\n                                  {{theme.downloads}}\n                                </div>\n                              </uip-tooltip>\n                            </div>\n                          </div>\n                        </div>\n                        <div class="uip-text-s uip-text-muted uip-max-w-100p uip-no-wrap uip-overflow-hidden uip-text-ellipsis">{{theme.description}}</div>\n                      </div>\n                    </div>\n                  </div>\n                </div>\n              </template>\n            </div>\n          </template>\n          \n          <div v-if="activeTemplate" class="uip-flex uip-flex-column uip-row-gap-s ">\n            <div class="uip-flex uip-flex-row uip-gap-xxs uip-flex-center uip-text-muted uip-link-muted" @click="activeTemplate = false">\n              <div class="uip-icon uip-text-l uip-icon-medium">chevron_left</div>\n              <div class="">{{strings.backToAllThemes}}</div>\n            </div>\n            <div @mouseenter="imageHover = true" @mouseleave="imageHover = false" class=" uip-max-w-100p uip-position-relative">\n              <div ref="imgHover" :style="getBackgroundImg(activeTemplate.images[imageIndex])" class="uip-w-100p uip-border-round uip-border uip-ratio-16-10"\n                style="background-repeat: no-repeat;\n                background-position: center;\n                background-size: cover;\n                transition: transform 0.5s ease-out;">\n              </div>\n              <div @click="navImagesBackward()" class="uip-position-absolute uip-left-0 uip-translate-y-50 uip-top-50p uip-padding-xxs uip-cursor-pointer uip-fade-in" v-if="activeTemplate.images.length > 0 && imageHover">\n                <div class="uip-icon uip-text-xxl" >chevron_left</div>\n              </div>\n              <div @click="navImagesForward()" class="uip-position-absolute uip-right-0 uip-translate-y-50 uip-top-50p uip-padding-xxs uip-cursor-pointer uip-fade-in" v-if="activeTemplate.images.length > 0 && imageHover">\n                <div class="uip-icon uip-text-xxl">chevron_right</div>\n              </div>\n            </div>\n            <div class="uip-flex uip-flex-column uip-row-gap-xxxs">\n              <div class="uip-flex uip-flex-row uip-gap-xxs uip-flex-center">\n                <div class="uip-text-emphasis uip-text-l uip-text-emphasis">{{activeTemplate.name}}</div>\n                <div class="uip-flex uip-padding-xxxs uip-background-orange-wash uip-padding-left-xxs uip-padding-right-xxs uip-border-round uip-flex-center" v-if="activeTemplate.premium">\n                  <div class="">{{strings.includesProBlocks}}</div>\n                </div>\n              </div>\n              <div class="uip-text-muted">\n                {{strings.createdBy}} <a href="https://uipress.co" class="uip-link-default">{{activeTemplate.created_by}}</a>\n              </div>\n            </div>\n            <div class="uip-flex uip-flex-row uip-gap-xxs">\n              <div class="uip-text-xs uip-background-primary-wash uip-border-round uip-padding-xxs uip-post-type-label">{{activeTemplate.type}}</div>\n            \n              <uip-tooltip :message="strings.downloadcount">\n                <div class="uip-text-xs uip-background-primary-wash uip-border-round uip-padding-xxs uip-post-type-label uip-flex uip-flex-row uip-gap-xxxs">\n                  <span class="uip-icon">file_download</span>\n                  {{activeTemplate.downloads}}\n                </div>\n              </uip-tooltip>\n            \n              <div class="uip-text-xs uip-background-orange-wash uip-border-round uip-padding-xxs uip-post-type-label">{{strings.requires}} {{activeTemplate.requires}}</div>\n            </div>\n            <div class="uip-text-muted">{{activeTemplate.description}}</div>\n            <div class="uip-flex uip-gap-xs">\n              <drop-down dropPos="bottom-right">\n                <template v-slot:trigger>\n                  <button class="uip-button-primary uip-text-s uip-flex uip-gap-xs">\n                    <div class="">{{strings.addToTemplate}}</div>\n                    <div class="uip-icon uip-text-m uip-icon-medium">chevron_left</div>\n                  </button>\n                </template>\n                <template v-slot:content>\n                  <div class="uip-padding-xs uip-flex uip-flex-column uip-row-gap-xs uip-text-right">\n                    <div @click="addToContent(\'replace\', activeTemplate)" class="uip-link-muted">{{strings.replaceContent}}</div>\n                    <div @click="addToContent(\'add\', activeTemplate)" class="uip-link-muted">{{strings.addAtEndOfContent}}</div>\n                  </div>\n                </template>\n              </drop-down>\n            </div>\n          \n          </div>\n        \n        </div>\n\t\t  </div>'}};